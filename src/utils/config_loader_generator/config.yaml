config_loader_sh_template: |
  #!/usr/bin/env bash

  function load_config() {{
      if [[ "$2" != "NULL" ]]
          then
              printf "\t<property>\n\t\t<name>$1</name>\n\t\t<value>$2</value>\n\t</property>\n" >> "${{HADOOP_CONF_DIR}}/$3"
      fi
  }}

  function load_config_with_opt() {{
      if [[ "$2" != "NULL" ]]
          then
              printf "\t<property>\n\t\t<name>$1</name>\n\t\t<value>$3</value>\n\t</property>\n" >> "${{HADOOP_CONF_DIR}}/$5"
      else
          printf "\t<property>\n\t\t<name>$1</name>\n\t\t<value>$4</value>\n\t</property>\n" >> "${{HADOOP_CONF_DIR}}/$5"
      fi
  }}

  {load_fn_calls}

  # Add additional JARs to Hadoop classpath like AWS, S3 and Hadoop Streaming
  echo "export HADOOP_CLASSPATH=\$HADOOP_CLASSPATH:\$HADOOP_HOME/share/hadoop/tools/lib/*" >> "${{HADOOP_HOME}}/etc/hadoop/hadoop-env.sh"

config_files:
  - path: hadoop_configs/hdfs-site.yaml
    filename: hdfs-site.xml
  - path: hadoop_configs/yarn-site.yaml
    filename: yarn-site.xml
  - path: hadoop_configs/core-site.yaml
    filename: core-site.xml
  - path: hadoop_configs/mapred-site.yaml
    filename: mapred-site.xml

output_dir: ../../base